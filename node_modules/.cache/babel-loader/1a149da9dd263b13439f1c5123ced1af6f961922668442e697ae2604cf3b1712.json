{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useNavigate}from\"react-router-dom\";import axios from\"axios\";import\"./Home.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const works=[{id:1,image:\"/images/work1.png\",description:\"Ваша чистота - ваше спокойствие\"},{id:2,image:\"/images/work2.png\",description:\"Продавец шаурмы, который старается привлечь клиентов\"},{id:3,image:\"/images/work3.png\",description:\"Магазин комнатных растений\"},{id:4,image:\"/images/work4.png\",description:\"Блокнот, который меняет всё\"},{id:5,image:\"/images/work5.png\",description:\"Сапожник и путь за гвоздями\"},{id:6,image:\"/images/work6.png\",description:\"Маркетинг через историю героя-путешественника\"},{id:7,image:\"/images/work7.png\",description:\"Владелица пекарни и неожиданный успех\"},{id:8,image:\"/images/work8.png\",description:\"Умный дом — уют по щелчку\"},{id:9,image:\"/images/work9.png\",description:\"Ремонт старинных часов\"},{id:10,image:\"/images/work10.png\",description:\"Крафтовая упаковка подарков\"},{id:11,image:\"/images/work11.png\",description:\"Пекарня — аромат и уют\"},{id:12,image:\"/images/work12.png\",description:\"Воспоминания из одного путешествия\"},{id:13,image:\"/images/work13.png\",description:\"Продавец машин — контраст «до и после»\"},{id:14,image:\"/images/work14.png\",description:\"Онлайн-курс по мышлению\"}];const Home=()=>{const navigate=useNavigate();const[user,setUser]=useState(null);// Проверка авторизации\nuseEffect(()=>{axios.get(\"http://storysight.ru/api/auth/me\",{withCredentials:true}).then(res=>setUser(res.data)).catch(()=>setUser(null));},[]);// Telegram авторизация\nuseEffect(()=>{window.onTelegramAuth=async userData=>{try{await axios.post(\"http://storysight.ru/api/auth/login\",userData,{withCredentials:true});const res=await axios.get(\"http://storysight.ru/api/auth/me\",{withCredentials:true});setUser(res.data);}catch(err){console.error(\"Ошибка при Telegram входе:\",err);}};},[]);const handleLogout=async()=>{try{await axios.post(\"http://storysight.ru/api/auth/logout\",{},{withCredentials:true});setUser(null);}catch(err){console.error(\"Ошибка при выходе:\",err);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"home-container\",children:[/*#__PURE__*/_jsxs(\"nav\",{className:\"top-tabs\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"tab\",onClick:()=>navigate(\"/generate-character\"),children:\"\\u041A\\u043E\\u043D\\u0441\\u0442\\u0440\\u0443\\u043A\\u0442\\u043E\\u0440 \\u043F\\u0435\\u0440\\u0441\\u043E\\u043D\\u0430\\u0436\\u0430\"}),/*#__PURE__*/_jsx(\"span\",{className:\"tab\",onClick:()=>navigate(\"/my-projects\"),children:\"\\u041C\\u043E\\u0438 \\u043F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B\"})]}),/*#__PURE__*/_jsxs(\"main\",{className:\"main-content\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"headline\",children:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0439 \\u0441\\u0432\\u043E\\u044E \\u0438\\u0441\\u0442\\u043E\\u0440\\u0438\\u044E\"}),/*#__PURE__*/_jsx(\"p\",{className:\"subtitle\",children:\"\\u0421\\u0434\\u0435\\u043B\\u0430\\u0439 \\u0437\\u0430\\u043F\\u043E\\u043C\\u0438\\u043D\\u0430\\u044E\\u0449\\u0443\\u044E\\u0441\\u044F \\u0438\\u0441\\u0442\\u043E\\u0440\\u0438\\u044E \\u0434\\u043B\\u044F \\u0441\\u0432\\u043E\\u0435\\u0433\\u043E \\u0431\\u0438\\u0437\\u043D\\u0435\\u0441\\u0430 \\u0437\\u0430 3 \\u0448\\u0430\\u0433\\u0430.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"button-group\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:()=>navigate(\"/create-choice\"),children:\"\\u041D\\u0430\\u0447\\u0430\\u0442\\u044C\"}),!user?/*#__PURE__*/_jsx(\"div\",{id:\"telegram-login\",className:\"telegram-login-wrapper\",children:/*#__PURE__*/_jsx(\"script\",{async:true,src:\"https://telegram.org/js/telegram-widget.js?7\",\"data-telegram-login\":\"zavod_worker_bot\"// ЗАМЕНИ на имя своего бота без @\n,\"data-size\":\"large\",\"data-userpic\":\"true\",\"data-request-access\":\"write\",\"data-on-auth\":\"onTelegramAuth\"})}):/*#__PURE__*/_jsxs(\"div\",{className:\"user-info\",children:[user.photo_url&&/*#__PURE__*/_jsx(\"img\",{src:user.photo_url,alt:\"avatar\",className:\"user-avatar\"}),/*#__PURE__*/_jsx(\"span\",{className:\"user-name\",children:user.first_name}),/*#__PURE__*/_jsx(\"button\",{className:\"btn logout-btn\",onClick:handleLogout,children:\"\\u0412\\u044B\\u0439\\u0442\\u0438\"})]})]})]}),/*#__PURE__*/_jsx(\"section\",{className:\"portfolio\",children:works.map(work=>/*#__PURE__*/_jsxs(\"div\",{className:\"work-item\",children:[/*#__PURE__*/_jsx(\"img\",{src:work.image,alt:\"Work \".concat(work.id)}),/*#__PURE__*/_jsx(\"div\",{className:\"work-overlay\",children:/*#__PURE__*/_jsx(\"p\",{children:work.description})})]},work.id))})]});};export default Home;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","axios","jsx","_jsx","jsxs","_jsxs","works","id","image","description","Home","navigate","user","setUser","get","withCredentials","then","res","data","catch","window","onTelegramAuth","userData","post","err","console","error","handleLogout","className","children","onClick","async","src","photo_url","alt","first_name","map","work","concat"],"sources":["/var/www/storysight/src/pages/Home.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport \"./Home.css\";\n\nconst works = [\n    { id: 1, image: \"/images/work1.png\", description: \"Ваша чистота - ваше спокойствие\" },\n    { id: 2, image: \"/images/work2.png\", description: \"Продавец шаурмы, который старается привлечь клиентов\" },\n    { id: 3, image: \"/images/work3.png\", description: \"Магазин комнатных растений\" },\n    { id: 4, image: \"/images/work4.png\", description: \"Блокнот, который меняет всё\" },\n    { id: 5, image: \"/images/work5.png\", description: \"Сапожник и путь за гвоздями\" },\n    { id: 6, image: \"/images/work6.png\", description: \"Маркетинг через историю героя-путешественника\" },\n    { id: 7, image: \"/images/work7.png\", description: \"Владелица пекарни и неожиданный успех\" },\n    { id: 8, image: \"/images/work8.png\", description: \"Умный дом — уют по щелчку\" },\n    { id: 9, image: \"/images/work9.png\", description: \"Ремонт старинных часов\" },\n    { id: 10, image: \"/images/work10.png\", description: \"Крафтовая упаковка подарков\" },\n    { id: 11, image: \"/images/work11.png\", description: \"Пекарня — аромат и уют\" },\n    { id: 12, image: \"/images/work12.png\", description: \"Воспоминания из одного путешествия\" },\n    { id: 13, image: \"/images/work13.png\", description: \"Продавец машин — контраст «до и после»\" },\n    { id: 14, image: \"/images/work14.png\", description: \"Онлайн-курс по мышлению\" },\n];\n\nconst Home = () => {\n    const navigate = useNavigate();\n    const [user, setUser] = useState(null);\n\n    // Проверка авторизации\n    useEffect(() => {\n        axios\n            .get(\"http://storysight.ru/api/auth/me\", { withCredentials: true })\n            .then((res) => setUser(res.data))\n            .catch(() => setUser(null));\n    }, []);\n\n    // Telegram авторизация\n    useEffect(() => {\n        window.onTelegramAuth = async (userData) => {\n            try {\n                await axios.post(\"http://storysight.ru/api/auth/login\", userData, {\n                    withCredentials: true,\n                });\n                const res = await axios.get(\"http://storysight.ru/api/auth/me\", {\n                    withCredentials: true,\n                });\n                setUser(res.data);\n            } catch (err) {\n                console.error(\"Ошибка при Telegram входе:\", err);\n            }\n        };\n    }, []);\n\n    const handleLogout = async () => {\n        try {\n            await axios.post(\"http://storysight.ru/api/auth/logout\", {}, { withCredentials: true });\n            setUser(null);\n        } catch (err) {\n            console.error(\"Ошибка при выходе:\", err);\n        }\n    };\n\n    return (\n        <div className=\"home-container\">\n            <nav className=\"top-tabs\">\n                <span className=\"tab\" onClick={() => navigate(\"/generate-character\")}>\n                    Конструктор персонажа\n                </span>\n                <span className=\"tab\" onClick={() => navigate(\"/my-projects\")}>\n                    Мои проекты\n                </span>\n            </nav>\n\n            <main className=\"main-content\">\n                <h1 className=\"headline\">Создай свою историю</h1>\n                <p className=\"subtitle\">\n                    Сделай запоминающуюся историю для своего бизнеса за 3 шага.\n                </p>\n\n                <div className=\"button-group\">\n                    <button className=\"btn\" onClick={() => navigate(\"/create-choice\")}>\n                        Начать\n                    </button>\n\n                    {!user ? (\n                        <div id=\"telegram-login\" className=\"telegram-login-wrapper\">\n                            <script\n                                async\n                                src=\"https://telegram.org/js/telegram-widget.js?7\"\n                                data-telegram-login=\"zavod_worker_bot\" // ЗАМЕНИ на имя своего бота без @\n                                data-size=\"large\"\n                                data-userpic=\"true\"\n                                data-request-access=\"write\"\n                                data-on-auth=\"onTelegramAuth\"\n                            ></script>\n                        </div>\n                    ) : (\n                        <div className=\"user-info\">\n                            {user.photo_url && (\n                                <img src={user.photo_url} alt=\"avatar\" className=\"user-avatar\" />\n                            )}\n                            <span className=\"user-name\">{user.first_name}</span>\n                            <button className=\"btn logout-btn\" onClick={handleLogout}>\n                                Выйти\n                            </button>\n                        </div>\n                    )}\n                </div>\n            </main>\n\n            <section className=\"portfolio\">\n                {works.map((work) => (\n                    <div key={work.id} className=\"work-item\">\n                        <img src={work.image} alt={`Work ${work.id}`} />\n                        <div className=\"work-overlay\">\n                            <p>{work.description}</p>\n                        </div>\n                    </div>\n                ))}\n            </section>\n        </div>\n    );\n};\n\nexport default Home;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}